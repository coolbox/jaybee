<head>
  <title>jaybee</title>
  <script src="//connect.soundcloud.com/sdk.js"></script>
  <script>
    SC.initialize({
      client_id: "bddbc50b3432a6c8034ea30a8f73ee1c",
      redirect_uri: "http://dev.jaybee.com:3000/callback.html"
    });
  </script>
</head>

<body>
  <!-- {{> header}} -->

  {{> loggedIn}}
  <!-- {{#if currentUser}}
    {{> loggedIn}}
  {{else}}
    {{> loggedOut}}
  {{/if}} -->
</body>

<template name="header">
  {{#if currentUser}}
    <img src="{{currentUser.services.soundcloud.avatar_url}}" width="50"/>
  {{/if}}
  {{> loginButtons}}
</template>

<template name="loggedIn">
  <section>
    <aside class="search_col">
      {{> search}}
      {{> searchResults}}
    </aside><article class="playlist_col">
      {{> controls}}
      {{> playlist}}
    </article>
  </section>
</template>

<template name="loggedOut">
  <h1>Welcome to Jaybee</h1>
  <p>Log in with Soundcloud to get tune in.</p>
</template>

<template name="controls">
  <h2>Now Playing:</h2>
  <ul>
    {{#if now_playing}}
      {{#with now_playing}}
        <li>
          <a data-track-id="{{id}}">
            <img src="{{now_playing.artwork_url}}" width="50" />
            {{title}} - {{user.username}} <span><small>({{length duration}}) - ({{elapsed}})</small></span>
          </a>
        </li>
      {{/with}}
    {{/if}}
    <li><a data-control="play">Play</a></li>
    <li><a data-control="pause">Pause</a></li>
    <li><a data-control="next">Next</a></li>
  </ul>
</template>

<template name="playlist">
  <h2>Playlist</h2>
  {{#each tracks}}
    <li>
      <a data-track-id="{{id}}">
        <img src="{{artwork_url}}" width="50" />
        {{title}} - {{user.username}} <span><small>({{length duration}})</small></span>
      </a>
    </li>
  {{/each}}
</template>

<template name="search">
  <h2>Search:</h2>
  <form id="search_form">
    <input class="search" type="text" name="search" placeholder="Search for a trackâ€¦" />
  </form>
</template>

<template name="searchResults">
  <ul>
    {{#each results}}
      <li>
        <a data-track-id="{{id}}">
          <img src="{{artwork_url}}" width="50" />
          {{title}} - {{user.username}} <span><small>({{length duration}})</small></span>
        </a>
      </li>
    {{/each}}
  </ul>
</template>